# çš‡å®¶å°è™æ•°æ®ä¸­å°å‰ç«¯ã€ç®—æ³•

## TODO
- [ ] æ”¹ç”¨`scrapy`è¿›è¡Œçˆ¬è™«
- [ ] æ”¹ç”¨`node`ç«¯çš„`api`ï¼ˆä½¿ç”¨`nest`æ¡†æ¶ï¼‰
- [ ] ä½¿ç”¨`jsdom`é‡æ–°å®ŒæˆpddåŠ å¯†çš„hack,refer: [jsdom](#jsdom)
- [x] è§£å†³åŠ å¯†ç®—æ³•åªé€‚åˆæœ¬æœºçš„é—®é¢˜ï¼ˆåªè¦æœ¬æµè§ˆå™¨ç™»å½•è¿‡è´¦å·å°±å¯ä»¥å®ç°æ— éªŒç™»å½•ï¼Œä¹‹åä¸è¦æœ‰å¼‚å¸¸æ“ä½œå°±å¯ä»¥ï¼Œ2021å¹´05æœˆ12æ—¥ï¼‰
- [x] æµ‹è¯•åŸŸåå¯¹`cookie`çš„éªŒè¯å½±å“, refer: [domain](#domain)ï¼ˆæ— å½±å“ï¼Œ2021å¹´05æœˆ13æ—¥ï¼‰
- [x] éªŒè¯æ˜¯å¦ä¸»è´¦å·å¯ä»¥æŸ¥åˆ°æ‰€æœ‰å•†å“IDï¼ˆéƒ½å¯ä»¥ï¼Œä¹‹æ‰€ä»¥æœ‰è¿™ä¸ªé—®é¢˜æ˜¯å› ä¸ºä¹‹å‰å¯¹æ¯”é”™è´¦å·äº†ï¼Œ2021å¹´05æœˆ8æ—¥ï¼‰

<<<<<<< HEAD
=======
## ä½¿ç”¨è¯´æ˜
1. åˆå§‹åŒ–
```shell
cd hjxh-backend-v2
yarn  # éœ€è¦æå‰å®‰è£…å¥½å…¨å±€yarn

```

2. è¿è¡Œæµ‹è¯•
![img.png](.readme_images/img.png)

3. é€šè¿‡æµ‹è¯•
![img_1.png](.readme_images/img_1.png)

## ä¸šåŠ¡ç›¸å…³

### å­ç³»ç»Ÿä¸å­˜åœ¨ï¼Œ2021å¹´05æœˆ14æ—¥19:21:54

æ‰€ä»¥åªè¦å¡«ä¸€ä¸ªåˆæ³•çš„å­åŸŸåå°±å¯ä»¥ï¼Œæ¯”å¦‚æ‹¼å¤šå¤šè¥é”€ `PddBaseType.yx`

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-14/125423124178514.png?Expires=4774591316&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=Qu7QA1ME2OUlGqiutW132VQoWmg%3D)

### æµ‹è¯•ç»“æœ
No. | æµ‹è¯•é¡¹ | é¢„æœŸ | å®é™… | ç»“è®º
--- | --- | ---- | ---- | ----
1 | é€€å‡º`mms`ä¹‹åæ˜¯å¦èƒ½è·å–åˆ°`access_token` | ä¸èƒ½ | ä¸èƒ½ | å…·ä½“æŠ¥é”™ç»“æœï¼š {"error_msg":"ä¼šè¯å·²è¿‡æœŸ","error_code":43001,"success":false} 
2 | ä¸¤ä¸ªä¸åŒæµè§ˆå™¨ä¸Šç™»å½•çš„åŒä¸€è´¦æˆ·çš„`PASS_ID`æ˜¯å¦ç›¸åŒ | ä¸åŒ | ä¸åŒ| å…·ä½“ç»“æœï¼šè°·æ­Œï¼š`1-nLPI/4b4O4wJWNjs8xFzK53o+cf0gGLTnC5zY0oEwGNc8nVDM8LMSMW46z0kiVvlwbN/HGydYmr5LflYYNmq5A_506673970_93917892`ï¼Œç«ç‹ï¼š`1-E/oEqKUKa/GwkNwsHO4wpIvWEecSl1sznI9m1sn1KDqRmuyDUqIo3Qq+YzV34W6La/R6A8L801xeZtOl30UVNA_506673970_93917892`
3 | Aæµè§ˆå™¨çš„è´¦æˆ·é€€å‡º`mms`åæ˜¯å¦å½±å“Bæµè§ˆå™¨çš„è´¦æˆ· | ä¸ä¼š | ä¸ä¼š | æ¯ä¸ªæµè§ˆå™¨ä¹‹é—´çš„`PASS_ID`æ˜¯ç‹¬ç«‹çš„

### æµ‹è¯•å…³é—­æµè§ˆå™¨çª—å£å‰åçš„`cookie`ä¼šæœ‰ä»€ä¹ˆå˜åŒ–ï¼š`session`
å…³é—­ä¹‹å‰ï¼š
```text
// Semicolon separated Cookie File
// This file was generated by EditThisCookie
// Details: http://www.cookiecentral.com/faq/#3.5
// Example: http://www.tutorialspoint.com/javascript/javascript_cookies.htm
Set-Cookie3: _a42=4453b7b9-0c2c-45e7-93c5-742c079ca9b3; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898732"; version=0
Set-Cookie3: _bee=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898643"; version=0
Set-Cookie3: _crr=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898497"; version=0
Set-Cookie3: _f77=7c77a93c-6b8b-4922-a8fb-14e8846b3871; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898697"; version=0
Set-Cookie3: api_uid=rBReI2CcmNQW0kR23n0rAg==; path="/"; domain=.pinduoduo.com; path_spec; expires="2145916555.861178"; version=0
Set-Cookie3: rcgk=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898762"; version=0
Set-Cookie3: rckk=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898815"; version=0
Set-Cookie3: ru1k=7c77a93c-6b8b-4922-a8fb-14e8846b3871; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898857"; version=0
Set-Cookie3: ru2k=4453b7b9-0c2c-45e7-93c5-742c079ca9b3; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898898"; version=0
Set-Cookie3: _nano_fp=XpExX0C8npT8nqdalT_Oz0~xWR1eMSZtpEo~VNBE; path="/"; domain=mms.pinduoduo.com; path_spec; expires="2484789077"; version=0
Set-Cookie3: JSESSIONID=423A63D77A61FBE0B9B1C0DDB7DF78FA; path="/"; domain=mms.pinduoduo.com; path_spec; expires="0"; version=0
Set-Cookie3: mms_b84d1838=120,3397,3432,1202,1203,1204,1205; path="/"; domain=mms.pinduoduo.com; path_spec; expires="1629531456.36082"; version=0
Set-Cookie3: PASS_ID=1-TxQVt9VPgH4VuruY+LP3zHJiOX1Pdeh5aUWQIHywerrvAMaWjMK3XNoMaALLk7OkCgoq72Dsgm+36kOpdABA0w_506673970_93917892; path="/"; domain=mms.pinduoduo.com; path_spec; expires="1621755410.633412"; version=0
Set-Cookie3: x-visit-time=1620891455436; path="/"; domain=mms.pinduoduo.com; path_spec; expires="1629531455.436508"; version=0

```

å…³é—­ä¹‹åï¼š
```text
// Semicolon separated Cookie File
// This file was generated by EditThisCookie
// Details: http://www.cookiecentral.com/faq/#3.5
// Example: http://www.tutorialspoint.com/javascript/javascript_cookies.htm
Set-Cookie3: _a42=4453b7b9-0c2c-45e7-93c5-742c079ca9b3; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898732"; version=0
Set-Cookie3: _bee=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898643"; version=0
Set-Cookie3: _crr=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898497"; version=0
Set-Cookie3: _f77=7c77a93c-6b8b-4922-a8fb-14e8846b3871; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898697"; version=0
Set-Cookie3: api_uid=rBReI2CcmNQW0kR23n0rAg==; path="/"; domain=.pinduoduo.com; path_spec; expires="2145916555.861178"; version=0
Set-Cookie3: rcgk=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898762"; version=0
Set-Cookie3: rckk=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898815"; version=0
Set-Cookie3: ru1k=7c77a93c-6b8b-4922-a8fb-14e8846b3871; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898857"; version=0
Set-Cookie3: ru2k=4453b7b9-0c2c-45e7-93c5-742c079ca9b3; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898898"; version=0
Set-Cookie3: _nano_fp=XpExX0C8npT8nqdalT_Oz0~xWR1eMSZtpEo~VNBE; path="/"; domain=mms.pinduoduo.com; path_spec; expires="2484789077"; version=0
Set-Cookie3: JSESSIONID=69978C89AFD7382CDBBD1DBE7335F879; path="/"; domain=mms.pinduoduo.com; path_spec; expires="0"; version=0
Set-Cookie3: mms_b84d1838=120,3397,3432,1202,1203,1204,1205; path="/"; domain=mms.pinduoduo.com; path_spec; expires="1629531592.64073"; version=0
Set-Cookie3: PASS_ID=1-TxQVt9VPgH4VuruY+LP3zHJiOX1Pdeh5aUWQIHywerrvAMaWjMK3XNoMaALLk7OkCgoq72Dsgm+36kOpdABA0w_506673970_93917892; path="/"; domain=mms.pinduoduo.com; path_spec; expires="1621755410.633412"; version=0
Set-Cookie3: x-visit-time=1620891591941; path="/"; domain=mms.pinduoduo.com; path_spec; expires="1629531591.941735"; version=0

```

å˜åŒ–ä¸»è¦æ˜¯`JessonID | x-visit-time`è¿™ä¸¤ä¸ªå­—æ®µä»¥åŠå®ƒä»¬çš„`expire_time`ï¼š
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-13/25837409157270.png?Expires=4774491730&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=AbKFeoNSUxHA8br0cRU4YA%2BPBc4%3D)

### æµ‹è¯•å…³é—­æµè§ˆå™¨çª—å£åï¼Œä½¿ç”¨ä¹‹å‰çš„å®Œæ•´`mms-cookie`æ˜¯å¦å¯ä»¥è·å–åˆ°æ•°æ®
å…³é—­çª—å£åï¼Œä¾æ—§èƒ½è·å¾—`systemAccessToken | recentOrderList`

å†æ¬¡æ‰“å¼€çª—å£åï¼Œä¾æ—§èƒ½è·å¾—`recentOrderList`ï¼Œ`systemAccessToken`å°±ä¸æµ‹äº†ï¼Œè‚¯å®šå¯ä»¥

ç»“è®ºï¼š`jSessionID | x-visit-time`ä¼šå˜åŠ¨æ˜¯ä¸é‡è¦çš„ï¼Œé‡è¦çš„è¿˜æ˜¯`PASS_ID`ã€‚

### æµ‹è¯•å½»åº•å…³é—­æµè§ˆå™¨åï¼Œ`PASS_ID`ä¼šä¸ä¼šå˜ã€ä¸ä¼šã€‘
å½“å‰`PASS_ID`ï¼š 1-TxQVt9VPgH4VuruY+LP3zHJiOX1Pdeh5aUWQIHywerrvAMaWjMK3XNoMaALLk7OkCgoq72Dsgm+36kOpdABA0w_506673970_93917892

é‡æ–°å¯åŠ¨æµè§ˆå™¨åçš„`PASS_ID`ï¼š
1-TxQVt9VPgH4VuruY+LP3zHJiOX1Pdeh5aUWQIHywerrvAMaWjMK3XNoMaALLk7OkCgoq72Dsgm+36kOpdABA0w_506673970_93917892

è¿™æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥æµè§ˆå™¨çŠ¶æ€çš„å¼€å¯ã€å…³é—­çŠ¶æ€ä¸ä¼šå½±å“`PASS_ID`çš„æœ‰æ•ˆæ€§ï¼Œé€€å‡ºç™»å½•ã€æ¸…ç©º`Storage`è¿™äº›æ‰ä¼šã€‚

ç›®å‰`PASS_ID`çš„æœ‰æ•ˆæ—¶é—´æ˜¯10å¤©ï¼Œå°šä¸æ¸…æ¥šå³å°†è¿‡æœŸæ—¶ä¼šæ€æ ·ã€‚

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-13/26471167275153.png?Expires=4774492363&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=6Vum4UYx5THoY1Syii3KrEocvpA%3D)

### æµ‹è¯•åŒä¸€è´¦å·ã€ä¸åŒæµè§ˆå™¨çš„`nano_fp`æ˜¯å¦ç›¸åŒã€ä¸åŒã€‘
ç«ç‹ï¼š`XpEalpUxnpXyXqToXo_2zmpGnwf0Lw56s1VNG1Uj`

è°·æ­Œï¼š`XpExX0C8npT8nqdalT_Oz0~xWR1eMSZtpEo~VNBE`

ä¸åŒã€‚

### æµ‹è¯•åŒä¸€è´¦å·çš„ä¸åŒ`nano_fp`æ˜¯å¦å¯ä»¥æ··ç”¨ã€å¯ä»¥ã€‘
ä½¿ç”¨ç«ç‹çš„`_nano_fp`ï¼Œæ›´æ–°åˆ°è°·æ­Œ`cookie`é‡Œï¼Œé€šè¿‡äº†è·å–è®¢å•å’Œ`token`çš„æµ‹è¯•ã€‚

### æµ‹è¯•ä¸åŒè´¦å·çš„`nano_fp`æ˜¯å¦å¯ä»¥æ··ç”¨ã€å¯ä»¥ï¼Œ_nano_fpå¯ä»¥å†™æ­»ï¼Œä¸å¯ä»¥ä¸ºç©ºï¼Œä¸å¯ä»¥éšæœºã€‘
ç«ç‹`å¥½é£Ÿå…ˆç”Ÿ`çš„`_nano_fp`ï¼š`XpEalpUxnpXyXqToXo_2zmpGnwf0Lw56s1VNG1Uj`

æ›´æ–°åˆ°è°·æ­Œ`ä¹å’Œé£Ÿå“`çš„`cookie`é‡Œï¼Œé€šè¿‡äº†æµ‹è¯•ã€‚

è¯´æ˜ï¼š`_nano_fp`å¯ä»¥å†™æ­»ï¼ˆä½†ä¸èƒ½ä¸ºç©ºï¼Œä¹Ÿä¸èƒ½ä¸ºéšæœºå­—æ®µï¼Œè¿™æ ·æ— æ³•é€šè¿‡ï¼‰

æ‰€ä»¥ï¼š
> `_nano_fp`é€šç”¨å¯ä»¥å†™æ­»ã€‚
> é™¤æ­¤ä¹‹å¤–ï¼š`mms`æ¥å£åªéœ€è¦`PASS_ID`ï¼Œ`yingxiao`æ¥å£åªéœ€è¦`SUB_PASS_ID`ã€‚




### é€€æ¬¾é‡‘é¢å­—æ®µ

`sucRfOrdrAmt1d`ï¼Œä¸»è¦çœ‹å‰ç¼€`sucRfOrdrAmt`

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-10/63093222231277.png?Expires=4774248365&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=Dgvmo97ffXCD3pL16TZQK2dr7oI%3D)

>>>>>>> 52750c822cd766441ae0b1ea1808870965cab995
## å¼€å‘è¿›åº¦
### å¼€å§‹é…ç½® `nest.js` åç«¯ï¼Œ2021å¹´05æœˆ15æ—¥08:35:41
å®ç°äº†è‡ªå®šä¹‰ç»Ÿä¸€è¿”å›æ¥å£ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-15/8269320052490.png?Expires=4774646127&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=dW7LrAgwuPeBD7G%2Fo7EE9iDSpLM%3D)

è‡ªå®šè¿”å›æ ¼å¼éƒ¨åˆ†ä»£ç ï¼š
```ts
// src/core/interceptors/transform.interceptor.ts

@Injectable()
export class TransformResponseInterceptor implements NestInterceptor {
  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {
    const response = context.switchToHttp().getResponse<Response>();
    const statusCode = response.statusCode;
    return next.handle().pipe(
      map((data) => {
        console.log({ statusCode, _data: display(data) });

        return {
          result: Array.isArray(data) ? {data, length: data.length} : data,
          success: true,
          message: 'è¯·æ±‚æˆåŠŸ',
        };
      }),
    );
  }
}

```

å‚è€ƒï¼š
- [nestjs ç»Ÿä¸€è¿”å›æ ¼å¼ | Random thoughts](https://yueqingsheng.github.io/post/nestjs-tong-yi-fan-hui-ge-shi/)

### å‘ç°ä¹‹å‰çš„`mallId`å¯èƒ½æ˜¯é”™çš„ï¼Œ 2021å¹´05æœˆ14æ—¥10:08:28
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-14/92217193352746.png?Expires=4774558109&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=qgwD2ud1M7B1%2BXuK0lP5VCG9Z%2Fg%3D)


### å®Œç¾é€šè¿‡æ‰€æœ‰çš„æµ‹è¯•
å”¯ä¸€çš„é—®é¢˜å°±æ˜¯ï¼Œä»Šå¤©æˆ‘æ²¡åŠ¨firefoxï¼Œä¸ºå•¥æ™šä¸Šå…¨éƒ½å¤±æ•ˆäº†å‘¢â€¦â€¦è¿™å¯ä¸å¥½ï¼Œæ€»ä¸èƒ½æ¯å¤©éƒ½é‡æ–°å½•ä¸€ä¸‹`PASS_ID`å§ï¼Œè¯´å¥½çš„åå¤©å‘¢

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-13/54571919745875.png?Expires=4774520463&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=mOwmTN8DX8z8VfpUlpVDAwrEF5s%3D)


### å¼€å‘V2ç‰ˆbackendï¼Œ2021å¹´05æœˆ13æ—¥17:12:17

ä¸»è¦åŠ¨æœºæœ‰å¦‚ä¸‹ä¸¤ç‚¹ï¼š
1. å·²ç»æ‘¸æ¸…äº†å…·æœ‰`mms`ã€`yingxiao`ä¸¤ä¸ªå¹³å°çš„æ•°æ®è¦è·å–ï¼Œä¹‹å‰çš„`axios`é…ç½®ä¸å¤ªèƒ½æ»¡è¶³å½“ä¸‹çš„éœ€æ±‚
2. å·²ç»æ‘¸æ¸…äº†`_nano_fp | PASS_ID | SUB_PASS_ID`ç­‰å­—æ®µçš„ä¾èµ–å…³ç³»ï¼Œå¯ä»¥é€šè¿‡é‡æ–°è®¾è®¡ç®€åŒ–api
3. å¯ç”¨`yaml`é…ç½®çº§è¯·æ±‚

### å®Œæˆå¤šå¼€ï¼Œ2021å¹´05æœˆ13æ—¥17:08:51

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-13/31063735814320.png?Expires=4774496955&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=EeS1DOg9F22slGBErOFM0l6Im%2Bk%3D)

å‚è€ƒï¼š
- [Firefox å®˜æ–¹å°å·æ‰©å±•ï¼šå¸®ä½ åœ¨åŒä¸€ä¸ªç½‘ç«™ç™»å½•å¤šä¸ªè´¦å· - å°ä¼—è½¯ä»¶](https://www.appinn.com/firefox-multi-account-containers/)

### å·²å®ç°ä»`mms`è·å–`yingxiao`çš„`SUB_PASS_ID`ï¼Œå¹¶é€šè¿‡æµ‹è¯•ï¼Œ 2021å¹´05æœˆ13æ—¥14:57:06
æ ¸å¿ƒæ€è·¯ï¼š
å…ˆè°ƒç”¨`GEN_TOKEN`æ¥å£ï¼Œè·å¾—ç³»ç»Ÿ`accessToken`ï¼Œå†é€šè¿‡è¿™ä¸ª`accessToken`ç»“åˆ`sub_system_id`è·å–`userAccessToken`ï¼Œå³`yingxiao`çš„`SUB_PASS_ID`ã€‚è¿‡ç¨‹ä¸éš¾ï¼Œå…¨ç¨‹åªéœ€è¦`mms`çš„`cookie`å°±å¯ä»¥ï¼Œå…³é”®æ˜¯è¿™é‡Œæ¶‰åŠåˆ°äº†ä¸¤ä¸ª`access_token`ï¼Œæ‰€ä»¥ä¸€å¼€å§‹æ ¹æœ¬æ²¡åˆ†æ¸…ï¼Œè¿˜ä»¥ä¸ºæ˜¯åŒä¸€ä¸ªã€‚ï¼ˆå¹¸å¥½ä¹‹å‰ç ”ç©¶è¿‡`OpenAuth`ï¼‰

### ä¿®å¤æ•°æ®åº“ç¿»é¡µæ’å…¥é€»è¾‘ï¼Œ 2021å¹´05æœˆ11æ—¥11:28:50


### ts-jest Supportï¼Œ 2021å¹´05æœˆ10æ—¥01:42:06

å‚è€ƒï¼š

- [Installation | ts-jest](https://kulshekhar.github.io/ts-jest/docs/getting-started/installation)

### é…ç½®äº†`redux-devtool`ï¼Œ2021å¹´05æœˆ08æ—¥08:57:45

å‚è€ƒï¼š
https://github.com/zalmoxisus/redux-devtools-extension#13-use-redux-devtools-extension-package-from-npm

### å®Œæˆå¯¹`fetchPddData`åŸºäº`yield`çš„çˆ¬å–æ–¹å¼çš„å°è£…ï¼Œ2021å¹´05æœˆ07æ—¥

å…·ä½“è§`hjxh-web/node/src/fetch_pdd_data.ts`

### ã€é—®é¢˜ã€‘é‡åˆ°å†¯åŒå­¦è°·æ­Œæµè§ˆå™¨ä¸Šç”Ÿæˆçš„`cookie`ä¸èƒ½é€šè¿‡æœ¬åœ°åŠ å¯†ç®—æ³•çš„é—®é¢˜

å°è¯•äº†å¤šéï¼Œä»¥åŠåœ¨`cookie`ç®—æ³•ä¸­åŠ¨æ€åŠ å…¥`ua`ï¼Œä½†ç»“æœéƒ½ä¸è¡Œã€‚

å¾ˆæœ‰å¯èƒ½æ˜¯ç”Ÿæˆ`cookie`çš„è¿‡ç¨‹ä¸­åŠ å…¥äº†ä¸€äº›å…³äºæµè§ˆå™¨çš„å…¶ä»–ä¿¡æ¯ï¼Œæ‰€ä»¥æœ¬åŠ å¯†ç®—æ³•ä¸é€‚åº”ã€‚

æš‚æ—¶å…ˆåœ¨æˆ‘æœ¬åœ°å®Œæˆè´¦å·çš„å­˜å…¥æ“ä½œå§ã€‚ã€‚ã€‚

### ä¿®å¤`dbQuery`æ¨¡æ¿å‡½æ•°ç©ºç±»å‹å¯¼è‡´çš„æ•°æ®åº“`query`å¤±è´¥ä»¥è‡³äº`cors`é”™çš„é—®é¢˜

å› ä¸º`sort`å‡½æ•°è¾ƒä¸ºæ•æ„Ÿï¼Œæ‰€ä»¥ä¹‹å‰ç›´æ¥å°†`sort`è®°ä¸ºç©ºæˆ–è€…ç©ºå­—æ®µçš„æ–¹æ¡ˆæ˜¯ä¸å¯è¡Œçš„ã€‚

æœ€åè€ƒè™‘åˆ°`sort`åœ¨`uri`æ‹¼æ¥çš„æœ€åï¼Œæ‰€ä»¥å¯¹äºç©º`sort`ç›´æ¥ä¸å‚ä¸æ‹¼æ¥ï¼Œè§£å†³äº†é—®é¢˜ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œæœ‰æ—¶é—´è¿˜æ˜¯å¾—çœ‹ä¸€ä¸‹åç›¾éƒ¨åˆ†ï¼Œæƒ³æƒ³æ€æ ·è®¾è®¡æ¥å£ï¼Œæ‰èƒ½ä½¿æœåŠ¡ç«¯`query`æ›´ç¨³å¥ä¸æ–¹ä¾¿ã€‚

### å®Œæˆè·¯ç”±é…ç½®ï¼Œ2021å¹´05æœˆ06æ—¥

ä½¿ç”¨`react-router-dom`æ›¿æ¢äº†åŸå…ˆçš„åŸºäº`id`çš„å¯¼èˆªã€‚

å…¶å®æœ¬æ¥å¹¶ä¸æƒ³ç”¨è·¯ç”±çš„ï¼Œä½†æ˜¯åæ¥æ¶‰åŠåˆ°è¦åˆ†äº«ç‰¹å®šçš„é¡µé¢ç»™å†¯åŒå­¦ï¼Œè¿™ä¸ªæ—¶å€™æœ‰è·¯ç”±çš„ä¼˜è¶Šæ€§å°±ä½“ç°å‡ºæ¥äº†ï¼Œæ‰€ä»¥ç«‹å³æ¢ä¸Šäº†ã€‚

ç›®å‰æ¥çœ‹ï¼Œè²Œä¼¼é€Ÿåº¦æ˜¯æ¯”ä¹‹å‰çš„è¦å¿«å¾ˆå¤šçš„ï¼Œå¤§çˆ±~

## å¼€å‘ç»éªŒ
### ESMå¯¼å…¥æ”¯æŒã€åè¡€ã€‘ï¼Œ 2021å¹´05æœˆ14æ—¥18:21:34
referï¼š
- [ä½¿ç”¨ts-nodeç›´æ¥è¿è¡Œtsè„šæœ¬å’Œè¸©è¿‡çš„å‘ - SegmentFault æ€å¦](https://segmentfault.com/a/1190000039413384?utm_source=tag-newest)
- [Allow import of directories with index.ts and import of files without extension Â· Issue #1198 Â· TypeStrong/ts-node](https://github.com/TypeStrong/ts-node/issues/1198#issuecomment-762473617)

### å¼‚æ­¥å¯¼è‡´å­—å…¸ä¿¡æ¯ä¹±æ”¹çš„bugï¼Œ2021å¹´05æœˆ14æ—¥12:26:05
ç”±äºå°†æ‰€æœ‰é…ç½®æ–‡ä»¶å†™åœ¨äº†`reqDict`å†…ï¼Œè®©æ‰€æœ‰çš„ç”¨æˆ·å’Œç”¨æˆ·çš„å­è¿›ç¨‹è¯»å–ï¼Œè¿™å¯¼è‡´å°½ç®¡ç”¨äº†ä¸€ä¸ªå˜é‡å»æ¥å—ä»ç„¶æ˜¯æŒ‡é’ˆå¼•ç”¨ï¼Œå¯¼è‡´äº†å†…éƒ¨å‡½æ•°ä¿®æ”¹æŒ‡é’ˆä»è€Œä¹±å†™çš„é—®é¢˜ã€‚
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-14/100499172553087.png?Expires=4774566391&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=%2BAoex2Je3BGlxyAUMSXcPef44AI%3D)

å¦‚ä¸‹ï¼Œé›·æ¸¯åœ¨ç¬¬ä¸€é¡µçˆ¬å–å®Œä¹‹åå‡†å¤‡çˆ¬ç¬¬äºŒé¡µæ—¶ï¼Œå‚æ•°å·²ç»è¢«å…¶ä»–ç”¨æˆ·å¤šåŠ äº†7ï¼ˆuseræ‰“å¤´çš„çŸ­çš„é‚£ä¸ƒè¡Œï¼‰â€¦â€¦
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-14/100621752530247.png?Expires=4774566514&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=c1pcifwdWdjyF77qup05mWykTL8%3D)

è§£å†³æ–¹æ¡ˆè‡³å°‘æœ‰ä¸¤ç§ï¼š
ç¬¬ä¸€ç§ï¼Œåœ¨æ¯ä¸ªå­è¿›ç¨‹å†…è·å–çš„å­—å…¸å‚æ•°ï¼Œéƒ½ç”¨è§£æ„è·å–ï¼Œå³`{...reqDict}`ï¼Œä¿è¯éæŒ‡é’ˆå¼•ç”¨ã€‚

ä½†è¿™ç§æ–¹æ³•ï¼Œè¿˜æ˜¯ä¼šäº§ç”Ÿç–å¿½ã€‚

ç¬¬äºŒç§ï¼Œå°è£…å­—å…¸å‚æ•°ï¼Œå› ä¸ºæœ¬æ¥å°±ä¸æ˜¯ç›´æ¥æ“ä½œçš„æ–‡ä»¶çº§åˆ«çš„ï¼Œè€Œæ˜¯å·²ç»æœ‰äº†ä¸€å±‚è¯»å–å†è½¬æˆå­—å…¸çš„æ“ä½œï¼Œæ‰€ä»¥ä¸å¦¨åœ¨è¿™ä¸ªå±‚ç»§ç»­åŠ ä¸€å±‚è·å–`params`çš„å°è£…ï¼Œä»¥å‡½æ•°å½¢å¼è·å–å‚æ•°è€Œéé”®å½¢å¼ã€‚

åŸå…ˆä»£ç å¦‚ä¸‹ï¼Œå‘ä¸»ç¨‹åºè¿”å›ä¸€ä¸ªå…¨å±€å­—å…¸ï¼š
```ts
export const readRequestDict = (): { [key: string]: PddRequest } => {
  const requestPath = path.resolve(__dirname, "./config/request.yaml");
  const reqDict = jsyaml.load(fs.readFileSync(requestPath, "utf-8")) as { [key: string]: PddRequest };
  Object.keys(reqDict).forEach(
      (k) => (reqDict[k].basePath = reqDict[k].baseType === 1 ? PddBaseType.home : PddBaseType.yx)
  );
  return reqDict;
};
```

ä¿®æ”¹ä¸ºé€šè¿‡å‚æ•°è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œä»¥é¿å…å¯¹å…¨å±€å­—å…¸çš„ä¿®æ”¹ï¼Œä¹Ÿé¿å…å¯¹å…¶ä»–è¿›ç¨‹çš„å¹²æ‰°ï¼š
```ts
const REQUEST_CONFIG_PATH = path.resolve(__dirname, "./config/request.yaml");
const globalRequestDict = jsyaml.load(fs.readFileSync(REQUEST_CONFIG_PATH, "utf-8")) as { [key: string]: PddRequest };
Object.keys(globalRequestDict).forEach(
  (k) => (globalRequestDict[k].basePath = globalRequestDict[k].baseType === 1 ? PddBaseType.home : PddBaseType.yx)
);
export const readRequestDict = (key: string): PddRequest => {
  return { ...globalRequestDict[key] };
};
```

ç»“æœä½ çŒœæ€ä¹ˆç€ï¼Ÿ

è¿˜æ˜¯ä¸è¡Œï¼Œç¬‘æ­»ï¼Œæœ€åç›´æ¥ä¸Šäº†`lodash`çš„æ·±æ‹·è´ï¼š
```ts
export const readRequestDict = (key: RequestType): PddRequest => {
  // ä½¿ç”¨æ·±æ‹·è´
  return _.cloneDeep(globalRequestDict[key]);
};
```

**LODASH YYDS!**


### åº—é“ºè¿˜æ˜¯ç”¨æˆ·ï¼Œå·¨å¤§çš„å‘ï¼Œ2021å¹´05æœˆ14æ—¥11:33:58
åœ¨æ˜¨æ™šï¼Œæˆ‘ä»¬ä½¿ç”¨"é‚“é›ªæ¢…"çš„è´¦å·ï¼Œçˆ¬å–äº†åäº”ä¸‡æ¡è®¢å•æ•°æ®ï¼ŒåŸºäºæ‹¼å¤šå¤šçš„æ¥å£è®¾è®¡æˆ‘åœ¨æ‰€æœ‰ä¸šåŠ¡ä¸­å¢åŠ äº†`userId`æ ‡è¯†ï¼Œè¿™å¯¼è‡´æ¬¡æ—¥éœ€è¦æ›´æ¢è´¦å·ä½¿ç”¨"é›·æ¸¯"ï¼ˆä½†å®é™…æ˜¯åŒä¸€åº—é“ºï¼‰é‡æ–°è¿›è¡Œçˆ¬å–æ—¶ï¼Œç”±äºè®¢å•ç³»ç»ŸåŸºäºè®¢å•IDè€Œè®¾è®¡çš„IDï¼Œå¯¼è‡´æ‰€æœ‰æ•°æ®éƒ½æ— æ³•æ’å…¥ï¼Œäºæ˜¯ä»Šæ—¥çš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯ç™½çˆ¬ï¼Œé›·æ¸¯çš„çˆ¬å–é‡æ°¸è¿œéƒ½æ˜¯0â€¦â€¦

è§£å†³æ–¹æ¡ˆï¼Œæ˜¯åœ¨ä¸šåŠ¡é‡Œæ¯ä¸€æ¡å†è¡¥åŠ `mallId`å­—æ®µï¼Œç„¶åç”¨`mallId`æ ¡éªŒï¼Œä¹‹æ‰€ä»¥ä½¿ç”¨è¿™ä¹ˆå†—ä½™çš„è®¾è®¡ï¼Œä¸€æ–¹é¢æ˜¯å› ä¸º`userId | mallId`æš‚æ—¶éƒ½æœ‰ä¸€äº›ä»·å€¼ï¼Œå¦å¤–ä¸€æ–¹é¢å®ƒä»¬éƒ½æ˜¯ç”¨æ•°å­—å­˜å‚¨çš„ï¼Œæ‰€å ç©ºé—´å¯ä»¥æ¥å—ã€‚

### nvm not foundï¼Œ 2021å¹´05æœˆ14æ—¥10:37:50
ç”±äºç”¨çš„æ˜¯`brew`ï¼Œæ‰€ä»¥å¾€ä¸Šæœ‰äº›é…ç½®ä¸èƒ½ç”Ÿæ•ˆï¼Œå‚ç…§å®˜ç½‘çš„æ‰è¡Œï¼š
- [nvm â€” Homebrew Formulae](https://formulae.brew.sh/formula/nvm)

### æœ‰ç¬¦å·ä½å³ç§»ä¸ç¬¦å·ä½å³ç§»çš„bug
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-14/61078329158564.png?Expires=4774526970&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=NPJB7g%2BKKGBhCBkzD8N2np3yV1g%3D)


### typscript of headers
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-13/46470374369424.png?Expires=4774512362&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=s1MONp7b9Z89Ti2off83FKwaRk8%3D)


### AntiContent æµ‹è¯•ï¼šç›®æ ‡URLæ˜¯ä¸é‡è¦çš„ï¼Œä»»æ„ï¼ˆä½†ä¸èƒ½ä¸ºç©ºï¼‰ï¼Œ2021å¹´05æœˆ13æ—¥08:59:04
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-13/1628872986390.png?Expires=4774467520&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=uUdUrieP6HFz7aTFE6leODSO6JU%3D)


### æ•°æ®åº“çš„æŒä¹…æ›´æ–°å†—ä½™è®¾è®¡ï¼Œ 2021å¹´05æœˆ11æ—¥15:49:20
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-11/134088285379360.png?Expires=4774319361&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=zYkC6p0vhKB4Ic8bP1ZK76Q3vn4%3D)


### `eslint`æŠ¥`module`é”™è¯¯ï¼Œ 2021å¹´05æœˆ11æ—¥10:47:55

åœ¨`eslint`é…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ `node`ç¯å¢ƒ
```json
{
  "env": {
    "node": true
  }
}
```
å‚è€ƒï¼š
- [module is not defined and process is not defined in eslint in visual studio code - Stack Overflow](https://stackoverflow.com/questions/49789177/module-is-not-defined-and-process-is-not-defined-in-eslint-in-visual-studio-code)


### Mongoose è¿˜æ˜¯ Mongodb

#### mongoose vs mongodb

å°±ç›®å‰æ¥çœ‹ï¼Œç”±äºæ‹¼å¤šå¤šçš„æ¥å£è¾ƒå¤šï¼Œè€Œä¸”ä¸ä¸€è‡´ï¼Œæ‰€ä»¥è®¾è®¡è§„èŒƒçš„`Schema`
æ˜¯æ¯”è¾ƒæ£˜æ‰‹çš„ï¼Œå¦ä¸€æ–¹é¢ï¼Œç”²æ–¹çš„éœ€æ±‚ä¹Ÿå¯èƒ½æ—¶æœ‰å˜åŠ¨ï¼Œç›®å‰ä¸ºäº†ä¸šåŠ¡è€Œè®¾è®¡çš„æ•°æ®åº“è§„èŒƒå¯èƒ½ä¸èƒ½å¾ˆå¥½åœ°é€‚åº”ç”²æ–¹çš„éœ€æ±‚å˜æ›´ï¼›æœ€åè€ƒè™‘åˆ°å¹³å‡ä¸¤å€çš„æ€§èƒ½å·®å¼‚ï¼Œæœ€ç»ˆå†³å®šé€‰æ‹©ä½¿ç”¨Mongodbè€ŒéMongooseã€‚ å‚è€ƒï¼š

- [node.js - Difference between MongoDB and Mongoose - Stack Overflow](https://stackoverflow.com/questions/28712248/difference-between-mongodb-and-mongoose)
  ï¼ˆæˆ‘è§‰å¾—è¿™ä¸ªäººå›ç­”é—®é¢˜çš„æ¨¡å¼å¥½å¥½ï¼Œæä¾›äº‹å®è€Œéè§‚ç‚¹ï¼ï¼‰
- [Performance Difference in Mongoose vs MongoDB Native Driver | by bugwheels94 | Medium](https://bugwheels94.medium.com/performance-difference-in-mongoose-vs-mongodb-60be831c69ad)

#### mongoose æ€»å¯ä»¥æŠ¥é”™

å¥½å§â€¦â€¦å…¶å®å°±æ˜¯`Mongoose`çš„è¿æ¥æœºåˆ¶å¤ªéš¾ææ‡‚äº†ï¼Œåœ¨åšè´¦å·æ‰¹é‡æµ‹è¯•çš„æ—¶å€™ï¼Œ`db`æ˜¯ä¸ª`Connection`ï¼Œç„¶åè¿™æ ·åŒæ­¥å†™ç¼–è¯‘å™¨ä¸æŠ¥é”™ï¼Œä½†è¾“å‡ºæŠ¥é”™ï¼š

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-11/105901908617741.png?Expires=4774291174&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=9eLRuIS9QbcNvyv5e8gNyZtVo6g%3D)

æ”¹æˆå¼‚æ­¥åï¼Œç¼–è¯‘å™¨`typescript`æŠ¥é”™ï¼Œä½†æ˜¯ç»“æœæ˜¯å¯¹çš„ï¼ˆéœ€è¦åŠ `//@ts-ignore`ï¼‰ï¼š
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-11/106035859077064.png?Expires=4774291308&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=HNK7iOKm3xkSVMS44zcQvyPga%2FQ%3D)

#### è£…äº† `@types/mongoose`ä¹Ÿæ²¡ç”¨

æ‰€ä»¥æ•¢æƒ…æ˜¯`typescript`çš„é—®é¢˜å‘—ï¼Œé‚£æˆ–è®¸é—®é¢˜çš„ç­”æ¡ˆå°±åœ¨äºï¼š`@types/mongoose`å§ï¼

ç¡®è®¤ç›®å‰æ˜¯æ²¡æœ‰å®‰è£…`@types/mongoose`çš„ï¼š
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-11/106096169564485.png?Expires=4774291368&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=GjJc6P39lrMVIBGexAmfECGIUmc%3D)

å¥½å§â€¦â€¦è¾£é¸¡ï¼Œè£…äº†ä¹Ÿæ²¡ç”¨â€¦â€¦ï¼ˆå¯èƒ½æ˜¯æˆ‘çš„`Connection`é‚£è¾¹å†™çš„ä¸å¥½ï¼Ÿä½†æˆ‘å¯æ˜¯æŠ„çš„`MDN`çš„å•Šâ€¦â€¦anywayï¼Œå®åœ¨æ˜¯ä½¿ç”¨æˆæœ¬å¤ªé«˜äº†ï¼Œä»¥åå†ç”¨å§â€¦â€¦æˆ‘å»é€‰æ‹©`mongodb native dirver`äº†â€¦â€¦ï¼‰
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-11/106212578046549.png?Expires=4774291485&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=VIkeTAKayS7%2FAo41I%2BgzOZS%2Fhr4%3D)

#### ä¸€ç§ä¸æŠ¥é”™çš„ï¼Œä½†å¾ˆä¸‘é™‹çš„å®ç°æ–¹å¼

```js
new Promise((resolve) => resolve(
        db.collection(COLL_ACCOUNTS).find({}))
)
        .then((e: any) => {
          console.log({e})
        })
```

### åŸºäºä»¥ä¸Šï¼Œä½¿ç”¨`async/await`çš„æœ€ä½³å®ç°æ–¹å¼

```js
const f1 = async () => {
  const cursor = await db.collection(COLL_ACCOUNTS).find()
  while (await cursor.hasNext()) {
    console.log(await cursor.next())
  }
}

const f2 = async () => {
  const cursor = await db.collection(COLL_ACCOUNTS).find()
  console.log(await cursor.toArray())
}

f2()
```

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-11/109655644260239.png?Expires=4774294928&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=aj%2Bxfn5JiIIOd3Ta3igzPek7k4w%3D)

### æ—¥æœŸä¸æ—¶é—´æ§åˆ¶ï¼ˆæ‹¼å¤šå¤šæœåŠ¡ç«¯ã€jsç«¯ã€pythonç«¯ï¼‰ï¼Œ 2021å¹´05æœˆ10æ—¥16:14:58

ä»¥pddå®˜ç½‘çš„æ—¶é—´ä¸ºå‡†ï¼Œå…¶2021å¹´5æœˆ10å·é›¶ç‚¹çš„æ—¶é—´æˆ³ä¸º `1620576000`ã€‚
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-10/49275045546839.png?Expires=4774234547&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=f%2FGZ2zfKOEljysXfVF77q3RloQI%3D)

åœ¨`python`ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨`datetime.datetime(2021, 5, 10).timestamp()`å¾—åˆ°å€¼æ˜¯ç›¸åŒçš„ï¼š
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-10/49325049938852.png?Expires=4774234597&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=zXKArQzJJLEsd0H8QHYRAXRirAo%3D)

ï¼ˆæ³¨æ„ï¼š`datetime.date`è¿™ä¸ªç±»æ²¡æœ‰ç›´æ¥çš„`timestamp`æ–¹æ³•ï¼Œå¹¶ä¸”ä¹Ÿä¼šåœ¨ä¸`mongodb`ç­‰ç¬¬ä¸‰æ–¹æ‰“äº¤é“æ—¶å‡ºé”™ï¼Œæ‰€ä»¥èƒ½ä¸ç”¨å°±ä¸ç”¨ï¼Œæ¯•ç«Ÿ`datetime`æ˜¯`date`çš„çœŸè¶…é›†ã€‚ï¼‰

åœ¨`js`ä¸­ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œä½†æ˜¯éå¸¸è¦æ³¨æ„çš„ä¸€ä¸ªå‘æ˜¯ï¼Œæœˆä»½æ˜¯ä»0å¼€å§‹è®°çš„ï¼Œæ‰€ä»¥è¦`new Date(2021, 4, 10).getTime()`ï¼š
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-10/49426738409686.png?Expires=4774234699&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=YNIgVaPVGOO6Rd3XSrsflM7JqG0%3D)

å¦‚æœä½¿ç”¨`dayjs`åŒ…çš„è¯ï¼Œæ›´æ–¹ä¾¿ï¼š

```js
var d = dayjs('2021-05-10')
console.log('æ—¶é—´æˆ³ï¼ˆç§’ï¼‰: ', d.unix())
console.log('æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰: ', d.valueOf())
```

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-10/49702714596339.png?Expires=4774234975&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=Go36MueBnsbma6a6oZoh36kxlcI%3D)

è¿˜å¯ä»¥é€šè¿‡æ•°ç»„æ¥æ”¶å½¢å¼ï¼š
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-10/49767385785948.png?Expires=4774235039&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=zoNFps7rgj0pN0P442y%2F7U4lIGk%3D)

ä¸è¿‡ï¼Œæ ¹æ®å®˜æ–¹ä»‹ç»ï¼Œéœ€è¦åŠ `"dayjs/plugin/arraySupport"`æ’ä»¶ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥è¿™é‡Œå¯ä»¥ç›´æ¥è¿è¡Œï¼Œæˆ‘æœ¬æ¥æƒ³æˆªä¸ªæŠ¥é”™ä½œä¸ºå¯¹æ¯”çš„â€¦â€¦ï¼ˆå¯èƒ½ï¼Œè¢«å…¼å®¹äº†å§â€¦â€¦ï¼‰

å‚è€ƒï¼š

- [å­—ç¬¦ä¸² Â· Day.js](https://day.js.org/docs/zh-CN/parse/string)
- [Unix æ—¶é—´æˆ³ Â· Day.js](https://day.js.org/docs/zh-CN/display/unix-timestamp)
- [æ•°ç»„ Â· Day.js](https://day.js.org/docs/zh-CN/parse/array)
- [ArraySupport Â· Day.js](https://day.js.org/docs/zh-CN/plugin/array-support)

### ç»ˆäºè§£å†³æ¢è¡Œé—®é¢˜ï¼Œ 2021å¹´05æœˆ10æ—¥16:06:51

ç”±äºç³»ç»Ÿç”¨çš„`prettier`è¿›è¡Œæ¢è¡Œæ§åˆ¶ï¼Œè€Œå®ƒçš„`printWidth`é»˜è®¤å€¼æ˜¯80ï¼Œè¿™å¯¼è‡´æŸä¸€è¡Œä»£ç æƒ³ä¸æ¢è¡Œç»“æœè¢«æ¢äº†ï¼Œå› ä¸ºè§†è§‰ä¸Šè¿˜æœ‰å¾ˆå¤§ç©ºé—´ã€‚

æŸ¥çœ‹ç³»ç»Ÿçš„ä¸€äº›è®¾ç½®ï¼Œæœ‰80ã€120ä¸¤ä¸ªç•Œï¼Œ`CodeStyle`é‡Œæ”¹æˆ120æ— æ•ˆï¼Œå› ä¸ºè¢«`prettier`è¦†ç›–äº†ï¼Œäºæ˜¯è€ƒè™‘æ–°å»ºä¸€ä¸ªæœ¬åœ°`.prettierrc`æ–‡ä»¶ï¼Œä¿®æ”¹`printWidth`çš„å€¼ã€‚

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-10/48911727673232.png?Expires=4774234184&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=O69TJM%2BZPC9io21jlz%2FNHLv4I2Q%3D)

æœ€åæ•ˆæœå¦‚ä¸‹ï¼š

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-10/48740681382240.png?Expires=4774234013&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=z7IseE%2FS5BVj3LUYHXLtltIcUMo%3D)

å‚è€ƒï¼š

- [Options Â· Prettier](https://prettier.io/docs/en/options.html#print-width)

### ç»ˆäºè§£å†³è€è‡ªåŠ¨ä¹±æç¤ºåº“çš„é—®é¢˜ï¼Œ 2021å¹´05æœˆ10æ—¥14:52:33

ä¹‹å‰åœ¨åˆå§‹åŒ–é¡¹ç›®ä¹‹åï¼Œä¸ºäº†è§£å†³`promise`çš„é—®é¢˜ï¼Œä¿®æ”¹`tsconfig.json`é‡Œçš„`lib`ä¸º`es2015.primise`ï¼Œè¿™å¯¼è‡´å¾ˆå¤šå†…ç½®åº“æ— æ³•è¯†åˆ«ï¼Œæ¯”å¦‚`Array`ã€‚

ä½†æˆ‘è”æƒ³åˆ°`create-react-app`é¡¹ç›®é‡Œæ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥è§‰å¾—å¾ˆæœ‰å¯èƒ½è¿˜æ˜¯è‡ªå·±çš„é…ç½®é—®é¢˜ã€‚

ä¸­é€”è¿˜å°è¯•åˆ æ‰`@types/mongoose`åº“ï¼ˆå› ä¸ºè€æ˜¯è·³å‡º`mongoodse`é‡Œçš„`Array`ï¼Œè®©æˆ‘å¯¼å…¥ï¼Œä½†ä¸€å¯¼å…¥å°±é”™ï¼Œä¸å¯¼å…¥å°±åå¤æ¨ªè·³ï¼‰ï¼Œç»“æœåˆ å®Œä¹‹ååŸå…ˆåªè·³ä¸¤ä¸ªå¯é€‰`Array`
çš„å‡ºå¤„ï¼Œåæ¥å˜æˆå››ä¸ªâ€¦â€¦å…¶ä¸­ç¬¬ä¸€ä¸ªæ˜¯æ¥è‡ª`es2015`çš„ã€‚

æœ€åæ„è¯†åˆ°äº†æ˜¯`typescript`é…ç½®çš„é—®é¢˜ï¼Œä¸‹æ„è¯†åœ°ä¿®æ”¹äº†ä¸€ä¸‹ï¼š
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-10/44507751334980.png?Expires=4774229780&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=U%2BdBqy5diUjPJza5BSN62HbVQao%3D)

ç»“æœå°±æˆäº†ï¼è¿™ç´«è‰²ç²—æ–œå­—ä½“å¯å¤ªå¥½çœ‹äº†ï¼
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-10/44282669866479.png?Expires=4774229555&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=nefuMwsg4LYrVrBOC2E4m6d9c1Y%3D)

### å§æ§½ï¼Œä¸€è¡Œä»£ç è§£å†³`git push`å¡ä½çš„é—®é¢˜ï¼Œ 2021å¹´05æœˆ10æ—¥09:13:18

```shell
 git config --global core.askpass "git-gui--askpass"
```

å‚è€ƒï¼š

- [Git push hangs when pushing to Github? - Stack Overflow](https://stackoverflow.com/questions/16906161/git-push-hangs-when-pushing-to-github)

<a name='domain'></a>

### å…³äºcookieéªŒè¯403çš„é—®é¢˜ï¼Œ2021å¹´05æœˆ10æ—¥05:45:57

å…¶å®æ˜¯é€‰é”™äº†apiã€‚

éªŒè¯ç”¨æˆ·æ˜¯å¦æœ‰æ•ˆæœ‰ä¸¤ä¸ªapiï¼Œä¸€ä¸ªä¼šè¿”å›mallä¿¡æ¯ï¼ˆyingxiaoï¼‰ï¼Œä¸€ä¸ªä¸ç”¨ï¼ˆmmsï¼‰ã€‚

æˆ‘ä»¬ç›®å‰ä½¿ç”¨çš„æ˜¯å•†å®¶åå°çš„cookieï¼Œæ‰€ä»¥èµ°mmsæ¸ é“æ˜¯å¯ä»¥è·å¾—æœ‰æ•ˆä¿¡æ¯çš„ï¼Œä½†æ˜¯ç›´æ¥è®¿é—®yingxiaoä¼šå‡ºé—®é¢˜ã€‚

åè¿‡æ¥å¯ä»¥ä¸ï¼Ÿå¾…æµ‹è¯•

<a name="jsdom"></a>

### jsdomæˆ–è®¸æ˜¯pddåŠ å¯†ç®—æ³•çš„åˆä¸€å¤§æ€å™¨

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-10/1322153107609.png?Expires=4774186594&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=vaKrNv0Y%2Fb0TY%2BZ%2B5dwwUJvTxng%3D)

### å…³äºåœ¨`try...catch...finally`çš„`finally`ä¸­ä½¿ç”¨`return`çš„é—®é¢˜

å‚è€ƒï¼š

- [è§£å†³async/awaitæ»¥ç”¨äº§ç”Ÿçš„å›°å¢ƒ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/138331544)
- [java - Can we use "return" in finally block - Stack Overflow](https://stackoverflow.com/questions/18205493/can-we-use-return-in-finally-block)

### å…³äºä»`prop`è·å¾—çš„ä¼ å…¥`useState`çš„æ•°æ®ä¸ä¼šå†åº¦åˆ·æ–°ï¼Œ 2021å¹´05æœˆ09æ—¥14:15:39

å‚è€ƒï¼š

- [reactjs - React.useState does not reload state from props - Stack Overflow](https://stackoverflow.com/questions/54865764/react-usestate-does-not-reload-state-from-props)

### ã€é‡è¦ã€‘ å…³äºä¸åŒä½ç½®çš„cookieçš„å·®å¼‚ï¼Œ 2021å¹´05æœˆ08æ—¥21:31:33

åŸæ¥å¦‚æ­¤ï¼å¿…é¡»åœ¨æ‹¼å¤šå¤šå•†å®¶åå°é¡µé¢è¿›è¡Œcookieåˆ·æ–°ï¼Œå¦åˆ™cookieæ˜¯æ— æ•ˆçš„â€¦â€¦ï¼ˆæ¯”å¦‚åœ¨æ¨å¹¿é¡µé¢ï¼‰

### å…³äº`react-redux`çš„`connect`å‡½æ•°æç¤ºå¤ªå¤šå¹¶ä¸”å¾ˆæ…¢çš„é—®é¢˜ï¼Œ 2021å¹´05æœˆ08æ—¥21:01:58

è§£å†³æ–¹æ¡ˆå¾ˆç®€å•ï¼šå»æ‰ full method`å°±å¯ä»¥ã€‚

å»æ‰ä¹‹åï¼Œå°†æ‰“å¼€æ–°çš„ä¸–ç•Œï¼Œä¸€åˆ‡æ›´ç¾å¥½~

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-08/47818171510450.png?Expires=4774078921&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=9ahK4I3NdrubIXzVyF8tA4Tn9Wg%3D)

### å…³äºæ— æ³•å¿«æ·å¯¼å…¥è‡ªå®šä¹‰çš„`AntdIcon`ï¼Œ 2021å¹´05æœˆ08æ—¥20:24:57

å…¶å®æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦ç”¨ç»„ä»¶å½¢å¼å¯¼å…¥`AntdIcon`ï¼ˆå³ï¼Œå°–æ‹¬å·é‚£ç§ç»„ä»¶å¯¼å…¥æ–¹å¼ï¼‰ï¼Œæ‰€ä»¥è™½ç„¶åœ¨è‡ªå®šä¹‰çš„`AntdIcon`é‡Œæ²¡æœ‰ä½¿ç”¨`jsx`è¯­æ³•ï¼Œä½†è¿˜æ˜¯éœ€è¦æ”¹ä¸º`tsx`æ–‡ä»¶æ‰æ”¯æŒã€‚

### å…³äºmac dockå¤±æ•ˆã€æ— æ³•ç‚¹å‡»çš„æœ€ç»ˆè§£å†³æ–¹æ¡ˆï¼Œ2021å¹´05æœˆ08æ—¥08:05:32

ä¹‹å‰å‚è€ƒç½‘ä¸Šæ–‡ç« é‡‡å–äº†é‡å¯çš„æ–¹å¼ï¼Œä»Šå¤©æ—©ä¸Šåœ¨é«˜åº¦ä¸“æ³¨çš„æƒ…å†µä¸‹ä»”ç»†ç ”ç©¶äº†æ–‡ç« ï¼Œæ•é”çš„æ„è¯†åˆ°æœ€æœ‰å¯èƒ½æ˜¯ç¬¬ä¸‰æ–¹æ’ä»¶çš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯`mac forge`è¿™ä¸ªï¼Œæ¯•ç«Ÿå®ƒåŠ¨è¿‡äº†ç³»ç»Ÿè®¾ç½®ã€‚

æœ€åæˆ‘é€€å‡º`mac forge`åï¼Œæœç„¶è§£å†³äº†é—®é¢˜ï¼

å‚è€ƒï¼š

- [How to Fix Mac Dock getting Stuck? - Appuals.com](https://appuals.com/how-to-fix-mac-dock-getting-stuck/)

### reduxè®¾è®¡ä¸­ï¼Œselect å’Œ filter çš„åŒºåˆ«

æˆ‘æƒ³æ˜ç™½äº†ï¼Œå…¨å±€çš„åº—é“ºã€å•†å“ä¸€èˆ¬åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥selectå¿…é¡»æ”¾åœ¨å…¨å±€reduxé‡Œï¼Œè€Œfilterè¿™ç§å¤šé€‰çš„ä¸€èˆ¬ç”¨åœ¨å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥å°±æ”¾åœ¨ç»„ä»¶é‡Œã€‚

è¿™ä¸ªæ€è€ƒï¼Œæˆ‘è®¤ä¸ºå¾ˆæœ‰æ„æ€ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡æ€è€ƒè¿™ä¹ˆç»†è‡´çš„é—®é¢˜ã€‚

### ç›´æ¥åˆ·æ–°è·¯ç”±ï¼Œå¯¼è‡´é¦–é¡µçš„å¼‚æ­¥è½½å…¥æœªèƒ½é¢„å…ˆå®Œæˆ

æƒ³æ¥è¿™ä¹Ÿæ˜¯å¾ˆæœ‰æ„æ€çš„ä¸€ä»¶äº‹ã€‚

æˆ‘åœ¨é¦–é¡µæ‰§è¡Œ`users`ã€`goods`çš„é¢„å…ˆè·å–æ“ä½œï¼Œä½†æˆ‘ç°åœ¨åœç•™çš„ç½‘é¡µæ˜¯åœ¨è®¢å•åˆ†æè¿™ã€‚

äºæ˜¯æˆ‘æ‰§è¡Œè®¢å•åˆ†æé¡µçš„åˆ·æ–°ï¼Œå®ƒå°†æ ¹æ®ä»`store`ç›´æ¥è¯»å–çš„`users`ã€`goods`è¿›è¡Œæ˜¯å¦è·å–æ•°æ®çš„åˆ¤æ–­ï¼Œç”±äºåœ¨è¯¥é¡µåˆ·æ–°è½½å…¥ä¹‹æ—¶ï¼Œé¦–é¡µçš„æ•°æ®è·å–æ“ä½œè¿˜æœªå®Œæˆï¼Œäºæ˜¯æœ¬é¡µå°±æ— æ³•æ›´æ–°äº†ã€‚

è§£å†³æ–¹æ¡ˆåœ¨æˆ‘æ‰“å­—æ—¶çªç„¶æƒ³å‡ºæ¥äº†ï¼Œé‚£å°±æ˜¯å°†`useEffect`çš„ä¾èµ–ç”±`[]`æ”¹æˆåŸºäº`users`ã€`goods`çš„æ•°é‡å˜åŠ¨~

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-08/61172002745364.png?Expires=4774005546&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=QVyqpd0hxzfFzHvaU7irgqRBzhQ%3D)

ç„¶è€Œï¼Œå°´å°¬çš„äº‹æƒ…å‘ç”Ÿäº†ï¼Œæœ€åä¸€æ­¥çš„æ•°æ®è·å–çš„å‚æ•°ï¼Œæ˜¯æ²¡æœ‰æ•°æ®çš„ï¼Œ233333ï¼Œå› ä¸ºè¿™ä¸ªåº—é“ºçš„æ•°æ®è¿˜æ²¡æ›´æ–°Orzã€‚

### ts-node é…ç½®é—®é¢˜

`ts-node`çœŸæ˜¯ä¸ªç¥å¥‡çš„ç©æ„â€¦â€¦

åœ¨å°è£…äº†è‡ªå·±çš„`logger`åï¼Œè¿›è¡Œæµ‹è¯•ï¼Œç»“æœæ­»æ´»ä¸æˆâ€¦â€¦

å‚è€ƒï¼š

- [package.json - ts-node execute typescript with module import and module defined - Stack Overflow](https://stackoverflow.com/questions/63445821/ts-node-execute-typescript-with-module-import-and-module-defined)

æœ€ç»ˆåªéœ€è¦æ”¹`tsconfig.json`çš„`module`å°±å¯ä»¥äº†ï¼š

```json
{
  "compilerOptions": {
    "target": "es5",
    "module": "commonjs"
  }
}
```

### js reduceç”¨æ³•

åŸæ¥ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡ç»“æœï¼Œè€Œç¬¬äºŒä¸ªå‚æ•°æ‰æ˜¯æ•°ç»„å†…çš„æ¯ä¸ªå…ƒç´ ï¼Œè¿™ä¸€ç‚¹å’Œ`map`ã€`forEach`ç­‰æ•°ç»„å‡½æ•°æœ‰å¾ˆå¤§çš„åŒºåˆ«ï¼

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-07/54496392166889.png?Expires=4773998870&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=YL6C1U455BOB34pU4TafW6Fyrtw%3D)

### è§£å†³`FormData`æäº¤çš„é—®é¢˜

ä½¿ç”¨`qs.stringify`å¯ä»¥å®Œç¾è§£å†³ï¼Œå‚è€ƒï¼š

- [axiosä¸­æ–‡æ–‡æ¡£|axiosä¸­æ–‡ç½‘ | axios](http://axios-js.com/zh-cn/docs/index.html#%E4%BD%BF%E7%94%A8-application-x-www-form-urlencoded-format)

ä¸»è¦æ˜¯æˆ‘åœ¨`fastapi`å¯¹`user`é‡Œçš„`cookie`è®¾ç½®æˆäº†`form`æ ¼å¼ï¼Œæ‰€ä»¥éœ€è¦ç”¨è¿™ä¸ªæ‰‹æ®µã€‚

### è§£å†³`antd`é‡Œ`modal`å¥—`form`çš„ä¸€ç§æœ€ä½³å®è·µ

ç›´æ¥è°ƒç”¨`Modal.confirm`å¯ä»¥é¿å…ä½¿ç”¨`hook`å¯¼è‡´ä»£ç åˆ†ç¦»ï¼Œä½†è¿™æ ·ï¼Œå°±æ— æ³•ä½¿ç”¨åŸç”Ÿ`Modal`çš„`footer`å±æ€§ï¼Œä»¥å°†`Form`çš„æäº¤æŒ‰é’®ç»‘å®šåœ¨`Modal`çš„`Footer`ä¸Šã€‚

å‚è€ƒä»¥ä¸‹ï¼Œå¯ä»¥å¾—å‡ºä¸€ç§æ”¹å˜`onButtonProps`çš„å±æ€§ï¼Œä»è€Œè¾¾åˆ°ç»‘å®šçš„æ•ˆæœï¼Œå¾ˆæœ‰æ„æ€~ï¼š

- [reactjs - How to submit form component in modal dialogue using antd react component library - Stack Overflow](https://stackoverflow.com/questions/41221633/how-to-submit-form-component-in-modal-dialogue-using-antd-react-component-librar)
- [Button - Ant Design](https://ant.design/components/button/#API)

ã€update 2021å¹´05æœˆ07æ—¥21:35:30ã€‘ ç„¶è€Œè¿™ç§æ–¹æ¡ˆè¿˜æ˜¯ç¢°åˆ°äº†é—®é¢˜ã€‚ å› ä¸ºå¯¹`Form`éœ€è¦åšä¸€äº›éªŒè¯ï¼Œæ‰€ä»¥å¦‚æœç›´æ¥æŠŠ`Form`ç»‘å®šåˆ°`Confirm`æŒ‰é’®ï¼Œä¼šå¯¼è‡´æ— è®ºéªŒè¯ä¸å¦éƒ½ç›´æ¥å…³é—­äº†`Modal`
ï¼Œè¿™æ˜¯å¾ˆä¸ç¬¦åˆé¢„æœŸçš„ã€‚

çœ‹æ ·å­ï¼Œè¿˜æ˜¯å¾—ç”¨æœ´ç´ çš„ç©æ„ã€‚ã€‚

```typescript jsx
const updateUser = (record: UserInfo) => {
  Modal.confirm({
    width: 800,
    title: "æ›´æ–°ç”¨æˆ·ä¿¡æ¯",
    okButtonProps: {form: 'update_user', htmlType: 'submit'},
    content: (
      <Form
        id={'update_user'}
        labelCol={{span: 2}}
        onFinish={(e) => {
          console.log("finished", e)
        }}
      >
        ...
      </Form>
    )
  })
}
```

### é…ç½®prettierçš„è§„åˆ™

ä¸ºäº†æ–¹ä¾¿å°†é¡¹ç›®ä»`js`åŒæ­¥åˆ°`python`ï¼Œä¾‹å¦‚ï¼Œå°†ä¸€äº›å˜é‡è½¬ç§»è¿‡å»ï¼Œç”±äº`prettier`é»˜è®¤ç»“å°¾æ˜¯æœ‰åˆ†å·çš„ï¼Œæ‰€ä»¥è½¬ç§»åˆ°`python`ä¹‹åè¿˜å¾—æ‰‹åŠ¨å»é™¤ä¸æ–¹ä¾¿ã€‚

ç”±äº`js`æ˜¯å¯¹åˆ†å·ä¸æ•æ„Ÿçš„ï¼Œæ‰€ä»¥è€ƒè™‘ç›´æ¥ä»`prettier`çº§åˆ«å»é™¤è¿™äº›åˆ†å·ã€‚

æœ¬æ¥æƒ³æä¸ªå…¨å±€é…ç½®ï¼Œç»“æœå‘ç°ä¸æ”¯æŒï¼Œå‚è€ƒï¼š

- [Configuration File Â· Prettier](https://prettier.io/docs/en/configuration.html)

æœ€åçš„è§£å†³æ–¹æ¡ˆæ˜¯ç›´æ¥åœ¨`package.json`ä¸­æ·»åŠ å¯¹`prettier`çš„çº¦å®šï¼š

```json
{
  "prettier": {
    "semi": false
  }
}
```

æœ€åå¯¹ç‰¹å®šæ–‡ä»¶è¿›è¡Œæ ¼å¼åŒ–å³å¯ï¼Œéœ€è¦ä½¿ç”¨æ–‡ä»¶çº§åˆ«ï¼ˆé`VCS`çº§åˆ«ï¼‰çš„æ ¼å¼åŒ–ï¼Œå¦åˆ™ä¸èµ·ä½œç”¨ã€‚å…·ä½“åšæ³•å°±æ˜¯æŒ‰`Command + Control + Shift + L`ï¼Œç„¶åå‹¾é€‰`Whole File`ã€‚

### è§£å†³`Sider`å’Œ`Header`å‡å›ºå®šï¼Œä¸”`Sider`æ”¯æŒ`collapse`çš„é—®é¢˜

æ ¹æ®`antd`å®˜æ–¹æ–‡æ¡£ç»™å‡ºçš„`Layout`ç¤ºä¾‹ï¼Œæœ‰å•ç‹¬å›ºå®š`Sider`çš„ï¼Œä¹Ÿæœ‰å•ç‹¬å›ºå®š`Header`çš„ï¼Œéƒ½æ˜¯ä½¿ç”¨çš„`position: fixed`çš„æ‰‹æ®µã€‚

ç„¶è€Œï¼Œå½“æŠŠä¸¤ä¸ªåˆåœ¨ä¸€èµ·ï¼Œé—®é¢˜å°±å‡ºç°äº†ï¼Œå› ä¸º`fixed`å¸ƒå±€å¯¼è‡´æˆ‘ä»¬å¿…é¡»è¦è®¡ç®—`Slider`ä¼¸ç¼©çš„å®½åº¦ï¼Œä»è€Œäº§ç”Ÿéº»çƒ¦ï¼Œå¹¶ä¸”ç”±äº`Slider`å†…éƒ¨ä½¿ç”¨äº†ä¼¸ç¼©åŠ¨æ•ˆï¼ˆè¾ƒä¸ºå¤æ‚çš„`css`
ï¼‰ï¼Œè¿™å¯¼è‡´æœºå³ä½¿æˆ‘ä»¬è®¡ç®—çš„ç²¾å‡†æ— è¯¯ï¼Œä¹Ÿä¼šäº§ç”Ÿä¼¸ç¼©æ—¶éš¾ä»¥å¿å—çš„åŠ¨æ•ˆ+åˆ·æ–°ä¸åŒæ­¥çš„é—®é¢˜ã€‚

#### æ­¥éª¤ä¸€ï¼Œheaderså¸ƒå±€æ”¹ä¸ºsticky

è§£å†³çš„ç¬¬ä¸€ä¸ªåŠæ³•ï¼Œå°±æ˜¯å°†`header`çš„`fixed`æ”¹æˆ`sticky`ï¼Œè¿™æ ·åŒæ ·è¾¾åˆ°äº†å›ºå®šé¡¶éƒ¨çš„æ•ˆæœï¼Œå¹¶ä¸”è´´åˆå®¹å™¨ï¼Œä¸ä¼šå‡ºç°ä»¥`fixed`å¸ƒå±€éœ€è¦è®¡ç®—`width`çš„é—®é¢˜ï¼Œæ”¯æŒæµå¼è‡ªåŠ¨å¸ƒå±€ã€‚

å‚è€ƒï¼š

- [javascript - How to create sticky headers on scroll with react - Stack Overflow](https://stackoverflow.com/questions/62970456/how-to-create-sticky-headers-on-scroll-with-react)

#### æ­¥éª¤äºŒï¼Œcontentè®¾ç½®å›ºå®šé«˜åº¦

å‚è€ƒï¼š

- [html - Independent Overflow-y Scrolling on Sidebar and Content - Stack Overflow](https://stackoverflow.com/questions/35730748/independent-overflow-y-scrolling-on-sidebar-and-content)

### çªç„¶æ„è¯†åˆ°IDEæ€»æ˜¯è‡ªåŠ¨è¡¥å…¨`props`ã€`state`çš„åŸå› 

åªè¦åœ¨`live templates - React`é‡Œå»é™¤è¿™ä¸¤ä¸ªå°±å¯ä»¥ï¼
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-06/55299949224842.png?Expires=4773912367&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=6EnpKNapMRrN8pOPafH2A%2Fxh4jM%3D)

### å‰ç«¯CORSè·¨åŸŸå¤±è´¥â€¦â€¦

å¦‚æœæ˜¯åœ¨æœåŠ¡ç«¯ç›´æ¥ä½¿ç”¨`axios`ï¼ˆæˆ–è€…ä½¿ç”¨`python`ï¼‰å‘èµ·è¯·æ±‚ï¼Œå› ä¸ºå¯ä»¥ç›´æ¥è®¾ç½®`referer`ã€`cookie`ä¹‹ç±»ï¼Œæ‰€ä»¥å¯ä»¥æˆåŠŸã€‚

ä½†å¦‚æœæ˜¯åœ¨æµè§ˆå™¨ç«¯ï¼Œç”±äºæµè§ˆå™¨çš„`CORS`ç­–ç•¥ï¼Œå°±æ¯”è¾ƒéº»çƒ¦ã€‚æˆ‘ä»¬ä¸å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ç«¯è‡ªå®šä¹‰`cookie`ã€`referer`ä¹‹ç±»çš„å±æ€§ã€‚å¯¹äº`cookie`ï¼Œå¯ä»¥é€šè¿‡æ“æ§`document.cookie`è¿›è¡Œæ›´æ”¹ï¼Œæ¯”å¦‚ä½¿ç”¨`react`
çš„`react-cookie`åº“ã€‚å¯¹äº`referer`ï¼Œå°±éœ€è¦é€šè¿‡åå‘ä»£ç†ã€‚`react`å®˜ç½‘ç»™å‡ºäº†ä¸€ä¸ªä½¿ç”¨`http-proxy-middleware`çš„æ–¹æ¡ˆï¼Œå‚è€ƒï¼š

- [Proxying API Requests in Development | Create React App](https://create-react-app.dev/docs/proxying-api-requests-in-development/)

ä½†ç»è¿‡å®è·µè¯æ˜ï¼Œåœ¨æˆ‘ä¿è¯`cookie`ä¸æ­£å¸¸è®¿é—®ç›¸åŒï¼ˆæ¸…é™¤æœ¬åœ°`cookie`å†ä½¿ç”¨æ­£å¸¸`cookie`è¿›è¡Œ`set`ï¼‰ä¹‹åï¼Œå†æ¬¡è®¿é—®`pdd`çš„ç›®æ ‡ç½‘å€ã€‚
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-06/55309488341425.png?Expires=4773912376&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=xtvQQ9wi3O%2BeZvggH0hE8mnfh78%3D)

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-06/55316511552028.png?Expires=4773912383&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=E%2FWgG35Cxss7D6zkN2YZMswcE40%3D)

ä½†æœ€ç»ˆæŠ¥äº†ä»¥ä¸‹é”™è¯¯ï¼š

```json
{
  "success": false,
  "errorCode": 1,
  "errorMsg": "Unable to find your routing configuration!",
  "result": null
}
```

è¿™ä¸ªç»“æœè¡¨æ˜ï¼Œå¾ˆæœ‰å¯èƒ½ï¼Œ`pdd`å®˜æ–¹çš„ç½‘å…³å¯¹è®¿é—®æºè¿˜æ˜¯åšäº†æ¯”è¾ƒä¸¥æ ¼çš„é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•æˆåŠŸã€‚

### Array.prototype.some() è¿”å›é—®é¢˜

ç¬¬ä¸€ç§å†™æ³•ï¼Œä¼šæŠ¥warningï¼Œå› ä¸ºæ²¡æœ‰å¯¹æ‰€æœ‰ç»“æœè¿›è¡Œè¿”å›

```js
str.split(";").some((line) => {
    const [k, v] = line.split("=");
    if (k === key) {
        return v;
    }
});
```

ç¬¬äºŒç§å°±æ²¡é—®é¢˜äº†ã€‚

```js
str.split(";").some((line) => {
    const [k, v] = line.split("=");
    return k === key ? v : false
});
```

ä¸»è¦æ˜¯someçš„æœºåˆ¶éœ€è¦æ¥æ”¶ä¸€ä¸ªä¸ºçœŸçš„è¿”å›å€¼ã€‚

å‚è€ƒï¼š

- [Array.prototype.some() - JavaScript | MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/some)

### é˜»æ­¢eslintæ£€æŸ¥jsä»£ç 

ä¿®æ”¹`package.json`ä¸­`eslint`éƒ¨åˆ†çš„è®¾å®šï¼š

```json
{
  "ignorePatterns": [
    "src/hjxh-node/src/hack_core/*.js"
  ]
}
```

### åœ¨webstormçš„tsä¸­å¯¼å…¥js

éœ€è¦é…ç½®ä¸€ä¸‹`tsconfig.json`ä¸­çš„`allowJS`é€‰é¡¹ä¸º`true`æ‰å¯ä»¥å¯¼å…¥`js`æ–‡ä»¶ã€‚

### ç™»å½•æ—¶çš„å­—æ®µéœ€æ±‚

ç»è¿‡æµ‹è¯•ï¼Œåªéœ€è¦`_nano_fp`å­—æ®µï¼ˆç¼ºå¤±ä¼šè¿”å›å­˜åœ¨é£é™©ï¼‰å’Œ`_bee`å­—æ®µï¼ˆç¼ºå¤±éœ€è¦æ‰‹æœºéªŒè¯ï¼‰ã€‚

### æœåŠ¡å™¨å¸è½½modoboaï¼ˆæƒŠå–œï¼Œè²Œä¼¼æŠŠè¿™ä¸ªå¸è½½åï¼ŒæœåŠ¡å™¨çš„mongodbå†ä¹Ÿä¸ä¼šåŠ¨ä¸åŠ¨å®•æœºäº†ï¼‰

- [How do I uninstall this? Â· Issue #157 Â· modoboa/modoboa-installer](https://github.com/modoboa/modoboa-installer/issues/157)

### åæ§½è¯„ä»·æ•°æ®çš„æ•°æ®ç»“æ„

è¯„ä»·æ•°æ®çš„æ•°æ®è·å–æ–¹å¼ä¸å…¶ä»–apiéƒ½æœ‰äº›å·®å¼‚ã€‚

å…·ä½“åœ°è¯´ï¼Œå®ƒåˆ†ä¸ºåˆ—è¡¨æŸ¥è¯¢å’Œå•å“æŸ¥è¯¢ä¸¤ä¸ªapiï¼Œå…¶ä¸­åˆ—è¡¨æŸ¥è¯¢å¯ä»¥è·å¾—å¤šä¸ªå•å“å½“æ—¥çš„è¾ƒä¸ºè¯¦ç»†çš„æ•°æ®ï¼ˆä½†ä¸æ”¯æŒé€‰æ‹©æ—¥æœŸï¼Œå‚æ•°ä¸­æ²¡æœ‰æ­¤é¡¹ï¼‰ï¼Œè€Œå•å“æŸ¥è¯¢å´å¯ä»¥ç›´æ¥æŸ¥åˆ°è¿‘30æ—¥çš„æ•°æ®ï¼ŒåŒ…å«ä»¥ä¸‹æœ€å…³é”®çš„å‡ ä¸ªå­—æ®µï¼š

```text
statDate	String	2021-05-04
avgServRevScr1m	Number	4.572659912293966
avgDescRevScr1m	Number	4.570391652805081
avgLgstRevScr1m	Number	4.573113564191743
goodsUnfkUndfltRevCnt1m	Integer	6613
```

ä½†æ˜¯ï¼Œå…¶ä»–å­—æ®µçš„ä¿¡æ¯å°±æ²¡æœ‰äº†ã€‚

## JEST ç›¸å…³ï¼ˆç”±äºèµ·æ­¥ä½¿ç”¨ï¼Œç‰¹å•ç‹¬è®°å½•ï¼‰

### jestè¶…æ—¶é—®é¢˜
åŸå› æ˜¯åœ¨`jest`ä¸­é»˜è®¤5ç§’å†…å®Œæˆå¼‚æ­¥ä»£ç çš„æ‰§è¡Œï¼Œè¶…è¿‡åˆ™ä¼šæŠ¥é”™ï¼Œå¯¹ä»˜ä¸€äº›è¾ƒé•¿æ—¶é—´çš„æµ‹è¯•ï¼ŒæŠŠå®ƒæ”¹å¤§å°±å¥½

æˆåŠŸçˆ¬å®Œï¼š
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-13/48004399386705.png?Expires=4774513896&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=UqMWypAUXWYv9KGdKtVuAGUjCLM%3D)

é…ç½®å¦‚ä¸‹ï¼š

```js
// jest.setup.js

// è®¾ç½®ååˆ†é’Ÿ
jest.setTimeout(600000)
```

```js
// jest.config.js

module.exports = {
  preset: "ts-jest",
  testEnvironment: "node",
  setupFilesAfterEnv: [
    "jest-extended", 
    './jest.setup.js'
  ],
};
```

å‚è€ƒï¼š
- [javascript - Message "Async callback was not invoked within the 5000 ms timeout specified by jest.setTimeout" - Stack Overflow](https://stackoverflow.com/questions/49603939/message-async-callback-was-not-invoked-within-the-5000-ms-timeout-specified-by)

### TODO

- [ ] è§£å†³`create-react-app`çš„`jest`ç¯å¢ƒä¸º`jsdom`ä»è€Œæ— æ³•æµ‹è¯•`node`ç¯å¢ƒçš„ä¸€äº›`test`ç¨‹åºçš„é—®é¢˜

### jseté…ç½®extendï¼Œ 2021å¹´05æœˆ10æ—¥15:54:53

æœ¬æ¥åªæ˜¯ä¸ºäº†å¿«é€ŸéªŒè¯ä¸€ä¸ªå€¼æ˜¯ä¸æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œç»“æœå‘ç°æ¯”è¾ƒéº»çƒ¦ï¼Œæ¯•ç«Ÿ`number`å’Œ`Number`ä¸æ˜¯ä¸€å›äº‹ã€‚

ç¬¬ä¸€ç§æ–¹æ¡ˆæ˜¯`expect(value).toEqual(expect.any(Number))`ï¼Œå°±å¾ˆç¹çï¼Œè€Œä¸”è¿™ä¸ª`toEqual`æˆ‘å¾ˆä¸èƒ½æ¥å—ï¼Œå› ä¸ºæˆ‘çš„æ„å›¾å°±æ˜¯åˆ¤åˆ«ç±»å‹ï¼Œç»“æœå­—é¢æ„ä¹‰å´æ˜¯ç­‰äºä»€ä¹ˆå€¼ï¼Œè¿™ä¸å¥½ï¼Œè¿™å¤ªhackäº†ã€‚

ç¬¬äºŒç§æ–¹æ¡ˆæ˜¯ä½¿ç”¨`jest-extend`ï¼Œæˆ‘å‘ç°è¿™ä¸ªä¸é”™ï¼Œè€Œä¸”`star`æ•°è¿˜æŒºé«˜ï¼Œ`1.5 k`äº†ã€‚å®‰è£…å®Œåï¼Œç›´æ¥ä½¿ç”¨`expect(value).toBeNumber()`å°±å¯ä»¥ï¼Œè¿™ç®€ç›´å¤ªå‹å¥½äº†~

æ³¨æ„ï¼Œç¬¬äºŒç§æ–¹æ³•è¦ä¸‰æ­¥èµ°ï¼Œå®‰è£…`jest-extend`ï¼Œé…ç½®`jest.config.json`ï¼Œå†æ–°å¢`global.d.ts`æ–‡ä»¶ï¼Œè¿™äº›éƒ½æ˜¯å€¼å¾—çš„ã€‚

å‚è€ƒï¼š

- [jestjs - `toBeInstanceOf(Number)` does not work in jest - Stack Overflow](https://stackoverflow.com/questions/52551035/tobeinstanceofnumber-does-not-work-in-jest)
- [jest-community/jest-extended: Additional Jest matchers ğŸƒğŸ’ª](https://github.com/jest-community/jest-extended#typescript)

### ç»ˆäºé…ç½®å¥½äº†`jest`çš„`node`ç¯å¢ƒ

```js
// /Users/mark/projects/HJXH/hjxh-js/hjxh-backend/src/crawl/pdd.unit.test.ts
import {createPddClient, PddClientPlus} from "./pdd";

describe("pdd test", () => {
    let pdd: PddClientPlus;

    beforeAll(async () => {
        console.log("=== started test pdd ===");
        // é»˜è®¤ä½¿ç”¨æ•°æ®åº“ç¬¬ä¸€ä¸ªæ‹¼å¤šå¤šè´¦å·è¿›è¡Œåˆå§‹åŒ–
        pdd = await createPddClient();
    });

    it("pdd should pass verification", async () => {
        const e = await pdd.fetchUserInfo();
        expect(e).toBe(true);
    });
});
```

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-10/35174825782003.png?Expires=4774220447&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=yTCcYWSLhsqtJuAR6VePZUtMN%2Fk%3D)

å‚è€ƒï¼š

- [æµ‹è¯•å¼‚æ­¥ä»£ç  Â· Jest](https://jestjs.io/zh-Hans/docs/asynchronous)
- [Globals Â· Jest](https://jestjs.io/docs/api#beforeallfn-timeout)
- [jestjs - How to pass variable from beforeEach hook to tests in jest? - Stack Overflow](https://stackoverflow.com/questions/52397708/how-to-pass-variable-from-beforeeach-hook-to-tests-in-jest)

### åœ¨`node`ç¯å¢ƒé…ç½®`ts-jest`å¯åŠ¨å¤±è´¥çš„åŸå› ï¼Œ 2021å¹´05æœˆ10æ—¥10:23:07

å°è¯•äº†å¾ˆå¤šé…ç½®ï¼Œå‡æœªæˆåŠŸï¼Œåæ¥åœ¨`ts-jest`å®˜ç½‘æ‰¾åˆ°äº†åŸå› ã€‚

- [Presets | ts-jest](https://kulshekhar.github.io/ts-jest/docs/getting-started/presets)

å‚è€ƒä»¥ä¸Šé“¾æ¥ï¼Œåœ¨`ts-jest`ä¸­ï¼Œæœ‰ä¸‰ç§`preset`ï¼Œé»˜è®¤æ˜¯ç¬¬ä¸€ç§ï¼Œå³ä¼šæŠŠæ‰€æœ‰`ts | tsx`æ ¼å¼æ–‡ä»¶è½¬æˆ`js | jsx`ã€‚

æˆ‘å½“æ—¶æµ‹è¯•çš„æ–‡ä»¶ï¼Œç”±äºä¸ºäº†é€‚åº”`create-react-app`çš„é…ç½®ï¼Œåç§°ä¸º`pdd-request.test.js`ï¼Œæ˜¯`js`æ ¼å¼ï¼Œæ‰€ä»¥`ts-jest`ä¸ä¼šè‡ªåŠ¨å°†å®ƒè½¬ä¸º`commonjs`ã€‚ç„¶è€Œè¯¥æ–‡ä»¶é‡Œä½¿ç”¨äº†`import`
ï¼Œå±äº`esm`ï¼Œå› æ­¤æŠ¥é”™ã€‚

è§£å†³åŠæ³•å°±æ˜¯å°†`preset`æ”¹æˆ`ts-jest/presets/js-with-ts`ï¼Œè¿™æ ·æ‰€æœ‰çš„`ts | tsx | js | jsx`éƒ½èƒ½è½¬æˆ`commonjs`äº†ï¼Œä¸è¿‡æ­¤é€‰é¡¹éœ€è¦æ‰“å¼€`tsconfig.json`
ä¸­çš„`"allowJs": true`é€‰é¡¹ã€‚

### å…³äº`jest`æŠ¥é”™ï¼š`You should not use <Link> outside a <Router>`ï¼Œ2021å¹´05æœˆ10æ—¥02:46:31

å…¶å®è¿™ä¸ªé—®é¢˜ï¼Œæ˜¯å› ä¸º`create-react-app`çš„é»˜è®¤æµ‹è¯•æ–‡ä»¶`App.test.js`æ˜¯ç›´æ¥æ‹¿`App.tsx`è¿›è¡Œ`render`æµ‹è¯•ï¼Œç„¶è€Œå½“æ—¶æˆ‘çš„é¡¹ç›®ç›®å½•ï¼Œå·²ç»æŠŠä¸»é…ç½®ç§»åˆ°äº†`index.tsx`æ–‡ä»¶ï¼Œæ¯”å¦‚`store`
å’Œ`BrowserRouter`ç­‰ã€‚

æ‰€ä»¥è§£å†³æ–¹æ¡ˆå°±æ˜¯æŠŠ`index.tsx`ç®€åŒ–ï¼Œæ‰€æœ‰`Provider`å…¨å†™è¿›`App.tsx`ï¼ŒåŒ…æ‹¬`css`æ–‡ä»¶ã€‚

## ä¸šåŠ¡ç›¸å…³

### å­ç³»ç»Ÿä¸å­˜åœ¨ï¼Œ2021å¹´05æœˆ14æ—¥19:21:54

æ‰€ä»¥åªè¦å¡«ä¸€ä¸ªåˆæ³•çš„å­åŸŸåå°±å¯ä»¥ï¼Œæ¯”å¦‚æ‹¼å¤šå¤šè¥é”€ `PddBaseType.yx`

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-14/125423124178514.png?Expires=4774591316&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=Qu7QA1ME2OUlGqiutW132VQoWmg%3D)

### æµ‹è¯•ç»“æœ
No. | æµ‹è¯•é¡¹ | é¢„æœŸ | å®é™… | ç»“è®º
--- | --- | ---- | ---- | ----
1 | é€€å‡º`mms`ä¹‹åæ˜¯å¦èƒ½è·å–åˆ°`access_token` | ä¸èƒ½ | ä¸èƒ½ | å…·ä½“æŠ¥é”™ç»“æœï¼š {"error_msg":"ä¼šè¯å·²è¿‡æœŸ","error_code":43001,"success":false}
2 | ä¸¤ä¸ªä¸åŒæµè§ˆå™¨ä¸Šç™»å½•çš„åŒä¸€è´¦æˆ·çš„`PASS_ID`æ˜¯å¦ç›¸åŒ | ä¸åŒ | ä¸åŒ| å…·ä½“ç»“æœï¼šè°·æ­Œï¼š`1-nLPI/4b4O4wJWNjs8xFzK53o+cf0gGLTnC5zY0oEwGNc8nVDM8LMSMW46z0kiVvlwbN/HGydYmr5LflYYNmq5A_506673970_93917892`ï¼Œç«ç‹ï¼š`1-E/oEqKUKa/GwkNwsHO4wpIvWEecSl1sznI9m1sn1KDqRmuyDUqIo3Qq+YzV34W6La/R6A8L801xeZtOl30UVNA_506673970_93917892`
3 | Aæµè§ˆå™¨çš„è´¦æˆ·é€€å‡º`mms`åæ˜¯å¦å½±å“Bæµè§ˆå™¨çš„è´¦æˆ· | ä¸ä¼š | ä¸ä¼š | æ¯ä¸ªæµè§ˆå™¨ä¹‹é—´çš„`PASS_ID`æ˜¯ç‹¬ç«‹çš„

### æµ‹è¯•å…³é—­æµè§ˆå™¨çª—å£å‰åçš„`cookie`ä¼šæœ‰ä»€ä¹ˆå˜åŒ–ï¼š`session`
å…³é—­ä¹‹å‰ï¼š
```text
// Semicolon separated Cookie File
// This file was generated by EditThisCookie
// Details: http://www.cookiecentral.com/faq/#3.5
// Example: http://www.tutorialspoint.com/javascript/javascript_cookies.htm
Set-Cookie3: _a42=4453b7b9-0c2c-45e7-93c5-742c079ca9b3; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898732"; version=0
Set-Cookie3: _bee=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898643"; version=0
Set-Cookie3: _crr=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898497"; version=0
Set-Cookie3: _f77=7c77a93c-6b8b-4922-a8fb-14e8846b3871; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898697"; version=0
Set-Cookie3: api_uid=rBReI2CcmNQW0kR23n0rAg==; path="/"; domain=.pinduoduo.com; path_spec; expires="2145916555.861178"; version=0
Set-Cookie3: rcgk=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898762"; version=0
Set-Cookie3: rckk=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898815"; version=0
Set-Cookie3: ru1k=7c77a93c-6b8b-4922-a8fb-14e8846b3871; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898857"; version=0
Set-Cookie3: ru2k=4453b7b9-0c2c-45e7-93c5-742c079ca9b3; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898898"; version=0
Set-Cookie3: _nano_fp=XpExX0C8npT8nqdalT_Oz0~xWR1eMSZtpEo~VNBE; path="/"; domain=mms.pinduoduo.com; path_spec; expires="2484789077"; version=0
Set-Cookie3: JSESSIONID=423A63D77A61FBE0B9B1C0DDB7DF78FA; path="/"; domain=mms.pinduoduo.com; path_spec; expires="0"; version=0
Set-Cookie3: mms_b84d1838=120,3397,3432,1202,1203,1204,1205; path="/"; domain=mms.pinduoduo.com; path_spec; expires="1629531456.36082"; version=0
Set-Cookie3: PASS_ID=1-TxQVt9VPgH4VuruY+LP3zHJiOX1Pdeh5aUWQIHywerrvAMaWjMK3XNoMaALLk7OkCgoq72Dsgm+36kOpdABA0w_506673970_93917892; path="/"; domain=mms.pinduoduo.com; path_spec; expires="1621755410.633412"; version=0
Set-Cookie3: x-visit-time=1620891455436; path="/"; domain=mms.pinduoduo.com; path_spec; expires="1629531455.436508"; version=0

```

å…³é—­ä¹‹åï¼š
```text
// Semicolon separated Cookie File
// This file was generated by EditThisCookie
// Details: http://www.cookiecentral.com/faq/#3.5
// Example: http://www.tutorialspoint.com/javascript/javascript_cookies.htm
Set-Cookie3: _a42=4453b7b9-0c2c-45e7-93c5-742c079ca9b3; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898732"; version=0
Set-Cookie3: _bee=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898643"; version=0
Set-Cookie3: _crr=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898497"; version=0
Set-Cookie3: _f77=7c77a93c-6b8b-4922-a8fb-14e8846b3871; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898697"; version=0
Set-Cookie3: api_uid=rBReI2CcmNQW0kR23n0rAg==; path="/"; domain=.pinduoduo.com; path_spec; expires="2145916555.861178"; version=0
Set-Cookie3: rcgk=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898762"; version=0
Set-Cookie3: rckk=TTLP5ZyhUEFqloUMXbFUGktM14BIi0fH; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898815"; version=0
Set-Cookie3: ru1k=7c77a93c-6b8b-4922-a8fb-14e8846b3871; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898857"; version=0
Set-Cookie3: ru2k=4453b7b9-0c2c-45e7-93c5-742c079ca9b3; path="/"; domain=.pinduoduo.com; path_spec; expires="1652427408.898898"; version=0
Set-Cookie3: _nano_fp=XpExX0C8npT8nqdalT_Oz0~xWR1eMSZtpEo~VNBE; path="/"; domain=mms.pinduoduo.com; path_spec; expires="2484789077"; version=0
Set-Cookie3: JSESSIONID=69978C89AFD7382CDBBD1DBE7335F879; path="/"; domain=mms.pinduoduo.com; path_spec; expires="0"; version=0
Set-Cookie3: mms_b84d1838=120,3397,3432,1202,1203,1204,1205; path="/"; domain=mms.pinduoduo.com; path_spec; expires="1629531592.64073"; version=0
Set-Cookie3: PASS_ID=1-TxQVt9VPgH4VuruY+LP3zHJiOX1Pdeh5aUWQIHywerrvAMaWjMK3XNoMaALLk7OkCgoq72Dsgm+36kOpdABA0w_506673970_93917892; path="/"; domain=mms.pinduoduo.com; path_spec; expires="1621755410.633412"; version=0
Set-Cookie3: x-visit-time=1620891591941; path="/"; domain=mms.pinduoduo.com; path_spec; expires="1629531591.941735"; version=0

```

å˜åŒ–ä¸»è¦æ˜¯`JessonID | x-visit-time`è¿™ä¸¤ä¸ªå­—æ®µä»¥åŠå®ƒä»¬çš„`expire_time`ï¼š
![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-13/25837409157270.png?Expires=4774491730&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=AbKFeoNSUxHA8br0cRU4YA%2BPBc4%3D)

### æµ‹è¯•å…³é—­æµè§ˆå™¨çª—å£åï¼Œä½¿ç”¨ä¹‹å‰çš„å®Œæ•´`mms-cookie`æ˜¯å¦å¯ä»¥è·å–åˆ°æ•°æ®
å…³é—­çª—å£åï¼Œä¾æ—§èƒ½è·å¾—`systemAccessToken | recentOrderList`

å†æ¬¡æ‰“å¼€çª—å£åï¼Œä¾æ—§èƒ½è·å¾—`recentOrderList`ï¼Œ`systemAccessToken`å°±ä¸æµ‹äº†ï¼Œè‚¯å®šå¯ä»¥

ç»“è®ºï¼š`jSessionID | x-visit-time`ä¼šå˜åŠ¨æ˜¯ä¸é‡è¦çš„ï¼Œé‡è¦çš„è¿˜æ˜¯`PASS_ID`ã€‚

### æµ‹è¯•å½»åº•å…³é—­æµè§ˆå™¨åï¼Œ`PASS_ID`ä¼šä¸ä¼šå˜ã€ä¸ä¼šã€‘
å½“å‰`PASS_ID`ï¼š 1-TxQVt9VPgH4VuruY+LP3zHJiOX1Pdeh5aUWQIHywerrvAMaWjMK3XNoMaALLk7OkCgoq72Dsgm+36kOpdABA0w_506673970_93917892

é‡æ–°å¯åŠ¨æµè§ˆå™¨åçš„`PASS_ID`ï¼š
1-TxQVt9VPgH4VuruY+LP3zHJiOX1Pdeh5aUWQIHywerrvAMaWjMK3XNoMaALLk7OkCgoq72Dsgm+36kOpdABA0w_506673970_93917892

è¿™æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥æµè§ˆå™¨çŠ¶æ€çš„å¼€å¯ã€å…³é—­çŠ¶æ€ä¸ä¼šå½±å“`PASS_ID`çš„æœ‰æ•ˆæ€§ï¼Œé€€å‡ºç™»å½•ã€æ¸…ç©º`Storage`è¿™äº›æ‰ä¼šã€‚

ç›®å‰`PASS_ID`çš„æœ‰æ•ˆæ—¶é—´æ˜¯10å¤©ï¼Œå°šä¸æ¸…æ¥šå³å°†è¿‡æœŸæ—¶ä¼šæ€æ ·ã€‚

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-13/26471167275153.png?Expires=4774492363&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=6Vum4UYx5THoY1Syii3KrEocvpA%3D)

### æµ‹è¯•åŒä¸€è´¦å·ã€ä¸åŒæµè§ˆå™¨çš„`nano_fp`æ˜¯å¦ç›¸åŒã€ä¸åŒã€‘
ç«ç‹ï¼š`XpEalpUxnpXyXqToXo_2zmpGnwf0Lw56s1VNG1Uj`

è°·æ­Œï¼š`XpExX0C8npT8nqdalT_Oz0~xWR1eMSZtpEo~VNBE`

ä¸åŒã€‚

### æµ‹è¯•åŒä¸€è´¦å·çš„ä¸åŒ`nano_fp`æ˜¯å¦å¯ä»¥æ··ç”¨ã€å¯ä»¥ã€‘
ä½¿ç”¨ç«ç‹çš„`_nano_fp`ï¼Œæ›´æ–°åˆ°è°·æ­Œ`cookie`é‡Œï¼Œé€šè¿‡äº†è·å–è®¢å•å’Œ`token`çš„æµ‹è¯•ã€‚

### æµ‹è¯•ä¸åŒè´¦å·çš„`nano_fp`æ˜¯å¦å¯ä»¥æ··ç”¨ã€å¯ä»¥ï¼Œ_nano_fpå¯ä»¥å†™æ­»ï¼Œä¸å¯ä»¥ä¸ºç©ºï¼Œä¸å¯ä»¥éšæœºã€‘
ç«ç‹`å¥½é£Ÿå…ˆç”Ÿ`çš„`_nano_fp`ï¼š`XpEalpUxnpXyXqToXo_2zmpGnwf0Lw56s1VNG1Uj`

æ›´æ–°åˆ°è°·æ­Œ`ä¹å’Œé£Ÿå“`çš„`cookie`é‡Œï¼Œé€šè¿‡äº†æµ‹è¯•ã€‚

è¯´æ˜ï¼š`_nano_fp`å¯ä»¥å†™æ­»ï¼ˆä½†ä¸èƒ½ä¸ºç©ºï¼Œä¹Ÿä¸èƒ½ä¸ºéšæœºå­—æ®µï¼Œè¿™æ ·æ— æ³•é€šè¿‡ï¼‰

æ‰€ä»¥ï¼š
> `_nano_fp`é€šç”¨å¯ä»¥å†™æ­»ã€‚
> é™¤æ­¤ä¹‹å¤–ï¼š`mms`æ¥å£åªéœ€è¦`PASS_ID`ï¼Œ`yingxiao`æ¥å£åªéœ€è¦`SUB_PASS_ID`ã€‚




### é€€æ¬¾é‡‘é¢å­—æ®µ

`sucRfOrdrAmt1d`ï¼Œä¸»è¦çœ‹å‰ç¼€`sucRfOrdrAmt`

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-10/63093222231277.png?Expires=4774248365&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=Dgvmo97ffXCD3pL16TZQK2dr7oI%3D)

## ç”Ÿæ´»ç›¸å…³

### æ¯ä¸ªæœˆå¼€å¤´æ€»æ˜¯è¿™ä¹ˆéš¾

![](http://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/pasteimageintomarkdown/2021-05-06/55327436289141.png?Expires=4773912394&OSSAccessKeyId=LTAI4G8kArj75ch3irL8mUUJ&Signature=zRK%2BjDChIKWcoyO8a%2FuD0cVUuuE%3D)

